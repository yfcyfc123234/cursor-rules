---
alwaysApply: true
---

# UI 设计图还原规则

> 适用于蓝湖等 UI 设计图的一比一像素还原，特别是沉浸式栏的 APP 项目

## 核心原则

### 一比一像素还原

- **严格还原**：严格按照设计图的尺寸、颜色、字体、间距还原
- **精确像素**：使用精确的像素值，避免近似值或四舍五入
- **视觉一致性**：确保还原后的页面与设计图在视觉上完全一致

### 沉浸式状态栏处理

- **APP 项目特性**：APP 项目通常使用沉浸式状态栏
- **状态栏颜色**：状态栏颜色与页面背景色一致，实现沉浸式效果
- **内容区域适配**：内容区域需要考虑状态栏高度，避免内容被遮挡
- **安全区域**：考虑刘海屏、底部导航栏等安全区域

## 设计图识别和处理

### 设计图分析

当用户提供蓝湖设计图（效果图 + 切图）时：

1. **自动识别设计元素**
   - 识别页面布局结构（容器、组件、间距）
   - 提取颜色值（背景色、文字颜色、边框颜色等）
   - 提取字体信息（字体大小、字重、行高）
   - 提取尺寸信息（宽度、高度、内边距、外边距）
   - 识别图标和图片资源

2. **切图资源处理**
   - 优先使用提供的切图资源
   - 切图命名规范，便于引用
   - 考虑不同屏幕密度的适配（@1x、@2x、@3x）
   - 识别可拉伸图片（.9.png 或 stretchable 图片）

3. **用户补充描述**
   - 支持用户补充特殊交互需求
   - 支持用户描述动画效果
   - 支持用户说明特殊场景（如横竖屏适配）

### 还原流程

1. **布局结构还原**
   - 按照设计图的层级结构构建布局
   - 使用精确的尺寸值（避免使用 wrap_content 或 match_parent 导致偏差）
   - 保持设计图中的间距和边距

2. **视觉元素还原**
   - 颜色值完全匹配设计图（使用十六进制或资源文件）
   - 字体大小和字重与设计图一致
   - 圆角、阴影等视觉效果精确还原

3. **资源文件使用**
   - 切图资源按规范命名和放置
   - 图片资源考虑不同屏幕密度
   - 图标使用矢量图（SVG）或切图资源

## 技术实现

### Android 原生项目

#### 沉浸式状态栏实现

```kotlin
// 设置沉浸式状态栏
window.statusBarColor = Color.TRANSPARENT
window.decorView.systemUiVisibility = (
    View.SYSTEM_UI_FLAG_LAYOUT_STABLE
    or View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN
)

// 内容区域考虑状态栏高度
val statusBarHeight = getStatusBarHeight()
view.setPadding(0, statusBarHeight, 0, 0)
```

#### 精确尺寸使用

- 使用 `dp` 单位，但确保与设计图对应
- 设计图通常以 375x667（iPhone 6/7/8）或 360dp（Android）为基准
- 使用 `dimens.xml` 资源文件管理尺寸值
- 避免硬编码尺寸值

#### 颜色值管理

- 使用 `colors.xml` 资源文件管理颜色
- 颜色值使用十六进制格式（如 `#FF0000`）
- 确保颜色值与设计图完全一致

### Flutter 项目

#### 沉浸式状态栏实现

```dart
// 设置沉浸式状态栏
SystemChrome.setSystemUIOverlayStyle(
  SystemUiOverlayStyle(
    statusBarColor: Colors.transparent,
    statusBarIconBrightness: Brightness.dark, // 或 Brightness.light
  ),
);

// 使用 SafeArea 处理安全区域
SafeArea(
  child: YourWidget(),
)
```

#### 精确尺寸使用

- 使用 `MediaQuery` 获取屏幕信息
- 使用 `dp` 逻辑像素单位
- 设计图通常以 375x667 为基准，需要按比例缩放
- 使用常量或配置类管理尺寸值

#### 颜色值管理

- 使用 `Color` 类，颜色值使用十六进制（如 `Color(0xFFFF0000)`）
- 在主题或常量类中统一管理颜色
- 确保颜色值与设计图完全一致

## 响应式适配

### 屏幕适配原则

- **优先保证设计还原**：在保证设计图一比一还原的前提下，考虑不同屏幕尺寸
- **关键元素保持比例**：重要元素（如按钮、图标）保持设计图比例
- **内容区域适配**：文本内容区域可以适当适配，但保持视觉一致性

### 适配策略

1. **固定尺寸元素**
   - 图标、按钮等固定尺寸元素使用精确像素值
   - 考虑不同屏幕密度，使用对应的切图资源

2. **弹性布局元素**
   - 列表、卡片等可以使用弹性布局
   - 保持设计图中的间距和边距

3. **文本适配**
   - 文本大小可以按屏幕比例缩放
   - 但保持与设计图的视觉比例一致

## 质量检查

### 还原度检查

1. **视觉对比**
   - 将还原后的页面与设计图并排对比
   - 检查颜色、尺寸、间距是否一致
   - 检查字体大小和字重是否匹配

2. **交互检查**
   - 检查按钮、链接等交互元素是否正确
   - 检查动画效果是否符合设计
   - 检查特殊场景（如横竖屏）是否正确适配

3. **资源检查**
   - 检查切图资源是否正确使用
   - 检查图片资源在不同屏幕密度下是否清晰
   - 检查图标和图片是否按设计图显示

### 常见问题处理

1. **尺寸偏差**
   - 检查单位换算是否正确（px 转 dp）
   - 检查是否有额外的 padding 或 margin
   - 检查布局约束是否正确

2. **颜色偏差**
   - 检查颜色值是否完全匹配
   - 检查是否有透明度设置
   - 检查是否有颜色叠加效果

3. **字体偏差**
   - 检查字体大小是否匹配
   - 检查字重（fontWeight）是否正确
   - 检查行高（lineHeight）是否匹配

## 注意事项

1. **设计图基准**
   - 明确设计图的基准尺寸（如 375x667）
   - 按基准尺寸进行还原，然后适配其他尺寸

2. **切图资源**
   - 优先使用提供的切图资源
   - 切图命名要规范，便于维护
   - 考虑不同屏幕密度的切图资源

3. **性能考虑**
   - 在保证还原度的前提下，考虑性能
   - 合理使用图片资源（压缩、格式选择）
   - 避免过度使用阴影、渐变等复杂效果

4. **可维护性**
   - 使用资源文件管理颜色、尺寸、字符串
   - 避免硬编码值
   - 保持代码清晰易读
